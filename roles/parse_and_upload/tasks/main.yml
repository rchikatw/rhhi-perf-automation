---
- name: Parse sysbench output to  csv
  delegate_to: 127.0.0.1
  become: false
  run_once: true
  shell: |
    cat "./results/vm_results/sysbench-result.out" | egrep " cat|threads:|transactions|tps|read/write|min:|avg:|max:" | tr -d "\n" | sed 's/Number of threads: /\n/g' | sed 's/\[/\n/g' | sed 's/[A-Za-z\/]\{1,\}://g'| sed 's/ \.//g' | sed -e 's/read\/write//g'  -e 's/per sec.)//g' -e 's/ms//g' -e 's/(//g' -e 's/^.*cat //g' | sed 's/ \{1,\}/,/g' > ./results/vm_results/sysbench-result.csv
  tags:
    - to_csv